# DrawingMap
画布-前端训练项目

## 已实现功能

### 基础功能
- 整体UI布局
- 工具栏拖动
- 画布无极放大与拖动
- 画布重置

### 绘制与编辑
- 绘制矩形、圆形、三角形（十字光标点击放置）
- 文本工具：从参数面板输入内容，点击画布放置
- 图像工具：本地图片上传，点击画布放置；支持滤镜（无/绿色/暖色/冷色）与缩放
- 选择工具：点击对象选中，参数面板修改即时生效（矩形/圆形/三角形/文本，图片部分属性如滤镜/缩放）
- 图形样式：颜色、大小、透明度、边框宽度、边框颜色
- 文本样式：字体、字号、颜色、背景色、BIUS（加粗/斜体/下划线/删除线）

### 小地图与工具
- 小地图实时预览对象与视口，支持点击定位视口中心
- 橡皮擦：左键拖动按轨迹擦除命中的对象

### 关于AI生成
- 首先用python运行BackPost里的ai2SVG.py，生成后端端口后输入到src\AIImage\AiImage.vue的第66行后端请求地址中。随后可以正常运行npm run dev。AI生成按钮在右上角
- （API是我花20块买的，求求少用点，谢谢爹）



## 快速开始

```bash
npm install
npm run dev
# 打开 http://localhost:5173/
```

## 技术栈与关键文件

- 技术栈：`Vue 3`、`Pinia`、`Pixi.js 8`、`Ant Design Vue`、`Vite`、`JavaScript`、 `线程阻塞与异步处理`、 `JSWorker`
- 关键文件：
  - 画布页面：`src/Main-page/page.vue`
  - 参数面板：`src/Param-Controller/paramctl.vue`
  - 工具栏：`src/Toolbar/toolbar.vue`
  - 画布仓库：`src/Main-page/Store/canvasStore.js`
  - 渲染器：`src/renderer/Renderer.js`



## 问题记录
### 12.5  问题：持久化保存在保存后重新加载会将原先存在的元素再次写入indexDB缓存
### 12.4  问题：小地图在undo后会卡住，不渲染新的内容，redo后也不会将原先的内容进行重新渲染
### 12.4  问题：undo后不能redo，文本内容redo异常，橡皮擦擦除后不可redo/undo
### 11.30 问题：上传图像时，无法渲染到指定位置
### 11.28 问题：绘制元素时，鼠标点击位置与实际绘制位置偏移
- 问题描述：在绘制矩形、圆形、三角形等元素时，鼠标点击位置与实际绘制位置存在偏移，元素会显示在画面左上角，拖动画布时才会出现在正确位置。
- 问题分析：pixi世界坐标在点击时没有立刻渲染到画布上，导致元素显示在错误位置。
- 解决方法：在点击绘制工具时，先初步渲染元素的参数，待点击时渲染元素的位置。

