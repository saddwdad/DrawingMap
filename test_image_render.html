<!DOCTYPE html>
<html>
<head>
    <title>图片渲染测试</title>
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@7.x/dist/pixi.min.js"></script>
</head>
<body>
    <div id="test-container"></div>
    <button onclick="testSyncRender()">测试同步渲染</button>
    <button onclick="testAsyncRender()">测试异步渲染</button>
    <div id="log"></div>

    <script>
        const app = new PIXI.Application({ width: 800, height: 600 });
        document.getElementById('test-container').appendChild(app.view);

        function log(message) {
            document.getElementById('log').innerHTML += `<p>${message}</p>`;
        }

        // 测试同步渲染
        function testSyncRender() {
            log('=== 同步渲染测试 ===');
            
            const testUrls = [
                'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==', // 有效DataURL
                'https://via.placeholder.com/100x100.png', // 网络图片
                'invalid-url.png', // 无效URL
                '' // 空URL
            ];

            testUrls.forEach((url, index) => {
                try {
                    const texture = PIXI.Texture.from(url);
                    const sprite = new PIXI.Sprite(texture);
                    sprite.position.set(50 + index * 150, 100);
                    app.stage.addChild(sprite);
                    
                    log(`测试${index + 1}: URL长度=${url.length}, 纹理有效=${texture && texture.valid}`);
                } catch (error) {
                    log(`测试${index + 1}失败: ${error.message}`);
                }
            });
        }

        // 测试异步渲染
        function testAsyncRender() {
            log('=== 异步渲染测试 ===');
            
            const img = new Image();
            img.onload = () => {
                const texture = PIXI.Texture.from(img);
                const sprite = new PIXI.Sprite(texture);
                sprite.position.set(100, 300);
                app.stage.addChild(sprite);
                log('异步渲染成功');
            };
            img.onerror = () => {
                log('异步渲染失败: 图片加载错误');
            };
            img.src = 'https://via.placeholder.com/150x150.png';
        }
    </script>
</body>
</html>